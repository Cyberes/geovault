{% load allauth %}
{% if attrs.field %}
    {# Handle field passed as attrs.field (from fields template) #}
    {% with field=attrs.field %}
        <div class="mb-5">
            {% if not attrs.unlabeled %}
                <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                    {{ field.label }}
                    {% if field.field.required %}<span class="text-red-500">*</span>{% endif %}
                </label>
            {% endif %}
            {% if field.errors %}
                <div class="mb-2">
                    {% for error in field.errors %}
                        <p class="text-sm text-red-600">{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}
            {{ field }}
            {% if field.help_text %}
                {# Filter out the automatic "Forgot your password?" link from password field help text #}
                {% if 'Forgot your password' not in field.help_text %}
                    <div class="mt-2 text-sm text-gray-500">{{ field.help_text|safe }}</div>
                {% endif %}
            {% endif %}
        </div>
    {% endwith %}
{% else %}
    {# Handle direct field attributes #}
    {% if attrs.errors %}
        <div class="mb-2">
            {% for error in attrs.errors %}
                <p class="text-sm text-red-600">{{ error }}</p>
            {% endfor %}
        </div>
    {% endif %}
    <div class="mb-5">
    {% if attrs.type == "textarea" %}
        {% if slots.label %}
            <label for="{{ attrs.id }}" class="block text-sm font-medium text-gray-700 mb-1">
            {% slot label %}
            {% endslot %}
        </label>
        {% endif %}
        <textarea {% if attrs.required %}required{% endif %}
                  {% if attrs.rows %}rows="{{ attrs.rows }}"{% endif %}
                  {% if attrs.disabled %}disabled{% endif %}
                  {% if attrs.readonly %}readonly{% endif %}
                  {% if attrs.checked %}checked{% endif %}
                  {% if attrs.name %}name="{{ attrs.name }}"{% endif %}
                  {% if attrs.id %}id="{{ attrs.id }}"{% endif %}
                  {% if attrs.placeholder %}placeholder="{{ attrs.placeholder }}"{% endif %}
                  class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed">{% slot value %}{% endslot %}</textarea>
    {% else %}
        {% if attrs.type != "checkbox" and attrs.type != "radio" %}
            {% if slots.label %}
                <label for="{{ attrs.id }}" class="block text-sm font-medium text-gray-700 mb-1">
                {% slot label %}
                {% endslot %}
            </label>
            {% endif %}
        {% endif %}
        <input {% if attrs.required %}required{% endif %}
               {% if attrs.disabled %}disabled{% endif %}
               {% if attrs.readonly %}readonly{% endif %}
               {% if attrs.checked %}checked{% endif %}
               {% if attrs.name %}name="{{ attrs.name }}"{% endif %}
               {% if attrs.id %}id="{{ attrs.id }}"{% endif %}
               {% if attrs.placeholder %}placeholder="{{ attrs.placeholder }}"{% endif %}
               {% if attrs.autocomplete %}autocomplete="{{ attrs.autocomplete }}"{% endif %}
               {% if attrs.value is not None %}value="{{ attrs.value }}"{% endif %}
               type="{{ attrs.type }}"
               class="{% if attrs.type == 'checkbox' or attrs.type == 'radio' %}h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded{% else %}w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed{% endif %}">
        {% if attrs.type == "checkbox" or attrs.type == "radio" %}
            {% if slots.label %}
                <label for="{{ attrs.id }}" class="ml-2 text-sm text-gray-700">
                {% slot label %}
                {% endslot %}
            </label>
            {% endif %}
        {% endif %}
    {% endif %}
    {% if slots.help_text %}
        <p class="mt-1 text-sm text-gray-500">
            {% slot help_text %}
            {% endslot %}
        </p>
    {% endif %}
    </div>
{% endif %}
